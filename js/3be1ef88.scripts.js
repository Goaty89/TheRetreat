angular.module("ui.date",[]).constant("uiDateConfig",{}).directive("uiDate",["uiDateConfig",function(a){"use strict";var b;return b={},angular.extend(b,a),{require:"?ngModel",link:function(b,c,d,e){var f=function(){return angular.extend({},a,b.$eval(d.uiDate))},g=function(){var a=!1,d=f();if(e){var g=d.onSelect||angular.noop;d.onSelect=function(d,f){b.$apply(function(){a=!0,e.$setViewValue(c.datepicker("getDate")),g(d,f),c.blur()})},d.beforeShow=function(){a=!0},d.onClose=function(){a=!1},c.off("blur.datepicker").on("blur.datepicker",function(){a||b.$apply(function(){c.datepicker("setDate",c.datepicker("getDate")),e.$setViewValue(c.datepicker("getDate"))})}),e.$render=function(){var a=e.$viewValue;if(angular.isDefined(a)&&null!==a&&!angular.isDate(a))throw new Error("ng-Model value must be a Date object - currently it is a "+typeof a+" - use ui-date-format to convert it from a string");c.datepicker("setDate",a)}}c.datepicker("destroy"),c.datepicker(d),e&&e.$render()};b.$watch(f,g,!0)}}}]).constant("uiDateFormatConfig","").directive("uiDateFormat",["uiDateFormatConfig",function(a){var b={require:"ngModel",link:function(b,c,d,e){var f=d.uiDateFormat||a;f?(e.$formatters.push(function(a){return angular.isString(a)?jQuery.datepicker.parseDate(f,a):null}),e.$parsers.push(function(a){return a?jQuery.datepicker.formatDate(f,a):null})):(e.$formatters.push(function(a){return angular.isString(a)?new Date(a):null}),e.$parsers.push(function(a){return a?a.toISOString():null}))}};return b}]),angular.module("lloydsInnApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","ui.router","ui.date","google-maps","pasvaz.bindonce","HashBangURLs","home","concept","news","facilities","rooms","access","faq"]).config(["$stateProvider","$urlRouterProvider","$anchorScrollProvider","$httpProvider","$locationProvider",function(a,b,c,d,e){e.hashPrefix("!"),d.defaults.useXDomain=!0,b.otherwise("/home"),c.disableAutoScrolling(),a.state("/home",{url:"/home",templateUrl:"views/main.html"}).state("/concept",{url:"/concept",templateUrl:"views/concept.html"}).state("/news",{url:"/news",templateUrl:"views/news.html"}).state("/facilities",{url:"/facilities",templateUrl:"views/facilities.html"}).state("/rooms",{url:"/rooms",templateUrl:"views/rooms.html"}).state("/rooms.details",{parent:"/rooms",url:"/:shortName",templateUrl:"views/rooms.details.html"}).state("/access",{url:"/access",templateUrl:"views/access.html"}).state("/faq",{url:"/faq",templateUrl:"views/faq.html"}).state("otherwise",{redirectTo:"/home"})}]).controller("AppController",["$rootScope","$scope","$location","dataService","$timeout","$window",function(a,b,c,d,e,f){function g(a){var b=$(a);TweenMax.to(b,3*Math.random()+2,{css:{transform:"translateY(15px)",force3D:!0},repeat:-1,yoyo:!0,ease:Sine.easeInOut,delay:3*Math.random()+2})}var h=$(".hdr-logo"),i=$(".nav"),j=i.find(".nav-item"),k=$(".ftr"),l=[{left:"0",top:"40%"},{left:"25%",top:"10%"},{left:"45%",top:"75%"},{left:"60%",top:"20%"},{left:"80%",top:"60%"},{left:"100%",top:"10%"}],m=[],n=$(window);Modernizr.svg||$(".svg").each(function(){$(this).attr("src",$(this).attr("data-fallback")),$(this).parent().addClass("svg-fallback")}),b.dataService=d,b.status="notready",a.menuMinimised=!1,a.wpAPI="http://lloydsinn.com/wordpress/wp-json",b.$on("$locationChangeSuccess",function(){"/home"!==c.path()&&""!==c.path()?(a.menuMinimised||b.minimiseNav(),a.isHome=!1):(b.status="ready",a.isHome=!0,a.menuMinimised&&b.maximiseNav()),0,f.ga("send","pageview",{page:c.path()})}),b.showCalendar=!1,b.dateOptions={changeYear:!0,changeMonth:!0,yearRange:"1900:-0",beforeShow:function(a){var b=$(a).position().left;$(".ui-datepicker").appendTo($(".bkg-wrapper")),0,n.width()>600&&$(".ui-datepicker").css({left:b})},prevText:"",nextText:"",minDate:0,gotoCurrent:!0,onSelect:function(a){0;var b=Date.parse(a);$(".bkg-datepicker-checkout").datepicker("option","minDate",b.add(1).day())}},b.dateOptionsCO={changeYear:!0,changeMonth:!0,yearRange:"1900:-0",beforeShow:function(a){var b=$(a).position().left;$(".ui-datepicker").appendTo($(".bkg-wrapper")),0,n.width()>600&&$(".ui-datepicker").css({left:b})},prevText:"",nextText:"",gotoCurrent:!0},b.pickDate=function(){b.showCalendar=!0,e(function(){n.resize()},1)};var o={changeYear:!0,changeMonth:!0,yearRange:"-0:+02",beforeShow:function(a){var b=$(a).position().left;$(".ui-datepicker").appendTo($(".bkg-wrapper")),0,$(window).width()>600&&($(".ui-datepicker").css({left:b}),$(".ui-datepicker-div").css({left:b}))},prevText:"",nextText:"",minDate:0,gotoCurrent:!0,dateFormat:"dd/mm/yy"};$(".bkg-datepicker-checkin, .bkg-datepicker-checkout").datepicker(o),$(".bkg-datepicker-checkin").datepicker("option","onSelect",function(a){var c=moment(a,"DD/MM/YYYY");if(b.checkInDate=c.format("DD/MM/YYYY"),0,$(".bkg-datepicker-checkout").datepicker("option","minDate",c.add("days",1).format("DD/MM/YYYY")),"undefined"!=typeof b.checkOutDate){var d=moment(b.checkOutDate,"DD/MM/YYYY");0,0,0,d.isBefore(c)&&(d=c,b.checkOutDate=d.format("DD/MM/YYYY"))}}),$(".bkg-datepicker-checkout").datepicker("option","onSelect",function(a){0;var c=moment(a,"DD/MM/YYYY");0,b.checkOutDate=c.format("DD/MM/YYYY")}),b.sendBookingInfo=function(){if("undefined"==typeof b.checkInDate&&"undefined"==typeof b.checkOutDate)b.checkInDate=moment().format("DD/MM/YYYY"),b.checkOutDate=moment().add("days",1).format("DD/MM/YYYY");else if("undefined"==typeof b.checkOutDate){{Date.parse(b.checkInDate)}0,0,b.checkOutDate=moment(b.checkInDate,"DD/MM/YYYY").add("days",1).format("DD/MM/YYYY")}var a=moment(b.checkInDate,"DD/MM/YYYY"),c=moment(b.checkOutDate,"DD/MM/YYYY"),d={checkInDate:a.format("YYYY-MM-DD"),checkOutDate:c.format("YYYY-MM-DD")};window.open("http://lloydsinn.com/booking.php?"+$.param(d))},b.minimiseNav=function(){i.removeClass("nav-active").addClass("nav-animating"),TweenMax.to($(".hme-background"),1.5,{css:{opacity:0},ease:Quart.easeInOut}),TweenMax.to(h,1,{className:"-=active",ease:Quart.easeInOut}),TweenMax.to(h.find("span"),1,{css:{fontSize:"160px"},ease:Quart.easeInOut}),TweenMax.to(i,1.5,{css:{height:"44px",minHeight:"44px"},ease:Quart.easeOut,delay:0,onComplete:function(){i.removeAttr("style").removeClass("nav-active nav-animating"),i.children().removeAttr("style"),a.menuMinimised=!0}}),TweenMax.to(k,.8,{autoAlpha:1,overwrite:"all",ease:Expo.easeOut,delay:.6}),_.each(j,function(a,b){var c=$(a),d=m[b],f={top:0,transform:"translateY(0px)"};e.cancel(d),!c.hasClass("active-add")&&Modernizr.mq("(max-width: 480px)")&&(f.opacity=0),TweenMax.to(c,1,{css:f,repeat:0,overwrite:"all",ease:Quart.easeOut,scope:c,onComplete:function(){c.hasClass("active")&&c.removeAttr("style")}})}),m=[]},b.maximiseNav=function(){a.isHome,TweenMax.to($(".hme-background"),2,{css:{opacity:1},overwrite:"all",ease:Quart.easeInOut}),i.addClass("nav-animating nav-animating-max"),TweenMax.to(h,1,{className:"+=active",ease:Quart.easeInOut}),TweenMax.to(h.find("span"),1,{css:{fontSize:"260px"},ease:Quart.easeInOut}),TweenMax.to(i,1.5,{css:{height:"350px",minHeight:"350px"},ease:Quart.easeInOut,delay:.6,onComplete:function(){i.removeClass("nav-animating nav-animating-max").addClass("nav-active"),a.menuMinimised=!1}}),TweenMax.to(k,.8,{autoAlpha:1,ease:Expo.easeOut,delay:.5}),_.each(j,function(a,b){var c=$(a);g(c),TweenMax.to(c,1.5,{css:{opacity:1,top:l[b].top},overwrite:"auto",delay:.6,ease:Quart.easeInOut,onComplete:function(){var a=e(function(){},500*b);m.push(a)}})})},b.isActive=function(a){var b=c.path().split("/");return _.contains(b,a)},n.on("resize",function(){n.width()<600&&(i.removeAttr("style"),""===c.path()||"/home"===c.path()?$(".hme-background").height($(document).height()):$(".hme-background").css("height","100%"))})}]).service("dataService",["$http",function(a){var b=[];a.get("./rooms.json").success(function(a){b=a.rooms}),this.getRooms=function(a){var c=_.findWhere(b,{shortName:a});return c}}]).run(["$location","$rootScope","$timeout",function(a,b,c){var d=$(".nav"),e=$(".nav-item"),f=[{left:"0",top:"40%"},{left:"25%",top:"10%"},{left:"45%",top:"75%"},{left:"60%",top:"20%"},{left:"80%",top:"60%"},{left:"100%",top:"10%"}],g=$(".hme-background").attr("data-img-src");if(b.init=!0,b.socialInit=!1,b.isHome=!0,0,""===a.path()||"/home"===a.path()){$(".nav").addClass("nav-init"),b.init=!0;var h=new createjs.LoadQueue(!1);h.loadFile(g),h.on("complete",function(){$(".hme-background").css("background-image","url("+g+")"),TweenMax.fromTo($(".hme-background"),3,{css:{opacity:0}},{css:{opacity:1},overwrite:"all",ease:Quart.easeInOut});{var a=_.after(e.length,function(){d.css({height:"350px",minHeight:"350px"}),c(function(){TweenMax.to($(".btn-booknow"),1,{css:{className:"-=hidden"},overwrite:"all",ease:Quart.easeInOut}),TweenMax.to($(".ftr"),1,{css:{className:"-=hidden"},overwrite:"all",ease:Quart.easeInOut}),TweenMax.to($(".soc"),1,{css:{className:"-=hidden"},overwrite:"all",ease:Quart.easeInOut}),b.socialInit=!0},1500)});_.after(e.length,function(){_.each(e,function(a,b){var c=$(a);TweenMax.to(c,1.5,{css:{autoAlpha:1},overwrite:"all",ease:Quart.easeInOut,delay:.2*b})})})}c(function(){TweenMax.fromTo($(".hdr-logo-wrapper"),2,{css:{opacity:0}},{css:{opacity:1},overwrite:"all",ease:Quart.easeInOut}),_.each(e,function(b,c){var e=$(b),g=3,h={autoAlpha:1};Modernizr.mq("(max-width: 680px)")&&(h.autoAlpha=1,g=3),d.addClass("nav-animating"),e.css({opacity:0,top:f[c].top}),$(".nav").removeClass("nav-init nav-animating").addClass("nav-active"),TweenMax.to(e,g,{css:h,ease:Quart.easeOut,delay:.2*c,onComplete:a()}),TweenMax.to(e,3*Math.random()+2,{css:{transform:"translateY("+_.random(10,20)+"px)",force3D:!0},overwrite:"none",repeat:-1,yoyo:!0,delay:3*Math.random(),ease:Sine.easeInOut})})},2e3)},null,!1)}else b.socialInit=!0,$(".hme-background").css("background-image","url("+g+")"),$(".hdr-logo-wrapper").removeClass("hidden"),$(".btn-booknow").removeClass("hidden"),$(".ftr").removeClass("hidden"),c(function(){TweenMax.to($(".soc"),1,{opacity:1,onComplete:function(){$(".soc").removeClass("hidden")}})},1e3)}]),angular.module("HashBangURLs",[]).config(["$locationProvider",function(a){a.hashPrefix("!")}]),angular.module("home",[]).controller("HomeController",["$scope",function(a){a.title="Home",a.status="ready"}]),angular.module("concept",[]).controller("ConceptController",["$scope",function(a){a.title="Concept",a.status="ready"}]),angular.module("access",["google-maps"]).controller("AccessController",["$scope","$timeout",function(a,b){var c,d=[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels.icon",stylers:[{hue:"#000000"},{visibility:"on"},{invert_lightness:!0},{saturation:-100},{gamma:.5}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]}];$("html").hasClass("lt-ie9")&&$(".svg").each(function(){$(this).attr("src",$(this).attr("data-fallback")),$(this).parent().addClass("svg-fallback")}),a.googleMapView=!1,a.map={center:{latitude:1.2972,longitude:103.840316},zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP,mapOptions:{styles:d,panControl:!1,mapTypeControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL}},events:{tilesloaded:function(b){a.$apply(function(){c=b})},resize:function(b){c=b,a.$apply()}}},a.mapMarker={latitude:1.2972,longitude:103.840316},a.icon="images/98b3d20c.access-marker.png",a.toggleMap=function(){var d=$(".acc-map-wrapper").height();$(".angular-google-map-container").height(d),a.googleMapView=!a.googleMapView,b(function(){google.maps.event.trigger(c,"resize"),c.setCenter(new google.maps.LatLng(1.2972,103.840316))},1)},a.status="ready"}]),angular.module("news",[]).controller("NewsController",["$rootScope","$scope","$http","$filter",function(a,b,c,d){function e(d){var e=[];_.each(d,function(f){var g;c.get(a.wpAPI+"/media/"+f).success(function(a){g=a.source;var c={src:g};b.imageURLs.push(c)}).then(function(){e.push(g),0,e.length>=d.length&&(0,j.loadManifest(e,!0))})})}function f(){0;_.where(b.news,{loaded:!0});b.newsLoaded=!0,g()}function g(){_.each(h,function(a,b){var c=$('.news-item[data-news-id="'+a.id+'"]');0,a.loaded=!0,TweenMax.fromTo(c,.7,{top:60,opacity:0},{top:0,opacity:1,ease:Expo.easeOut,delay:.05*b})}),b.noMorePosts=b.news.length>=i?!0:!1,b.status="ready",b.$apply()}var h=[],i=0,j=new createjs.LoadQueue(!1);j.on("complete",f,null,!1),b.news=[],b.imageURLs=[],b.newsLoaded=!1,b.noMorePosts=!0,b.pageNum=0,b.postsPerPage=5,b.imagesToLoad=[],b.$watch(b.news,function(a,b){0},!0),b.loadNews=function(){b.newsLoaded=!1,b.pageNum++;var f={params:{page:b.pageNum,type:"news","filter[posts_per_page]":b.postsPerPage,"filter[orderby]":"menu_order"}};c.get(a.wpAPI+"/posts/",f).success(function(a,c,f){i=Number(f("x-wp-total")),h=[];var g=[];_.each(a,function(a){var c={title:a.title,content:a.content,publishedDate:d("date")(a.date,"dd.MM.yyyy"),image_1:"",image_2:"",image_3:"",image_4:"",image_5:"",loaded:!1,id:b.news.length},e=[_.toArray(a.post_meta.image_1)[0],_.toArray(a.post_meta.image_2)[0],_.toArray(a.post_meta.image_3)[0],_.toArray(a.post_meta.image_4)[0],_.toArray(a.post_meta.image_5)[0]];g.push(e),b.getImagesbyID(c,e),b.news.push(c),h.push(c)}),b.imagesToLoad=_.compact(_.flatten(g)),e(b.imagesToLoad),0})},b.getImagesbyID=function(d,e){_.each(e,function(e,f){""!==e&&c.get(a.wpAPI+"/media/"+e).success(function(a){var c=a.source,e={src:c};b.imageURLs.push(e),d["image_"+(f+1)]=c})})}}]),angular.module("rooms",["roomDetails"]).controller("RoomsController",["$scope","$location","$timeout",function(a,b,c){var d=$(".intro"),e=$(".rms-column"),f=$(".rms-wall"),g=d.height();a.showRooms=!1,a.$on("$locationChangeSuccess",function(){"/rooms"===b.path()&&a.resetRooms()}),a.init=function(){c(function(){a.showRooms=!0,TweenMax.from(f,1,{opacity:0}),$(".rms-column").each(function(a){TweenMax.fromTo($(this),.5,{opacity:0,marginTop:20},{opacity:1,marginTop:0,delay:.1*a,ease:Quart.easeOut})}),a.status="ready"},1e3)},a.resetRooms=function(){var a=1;Modernizr.mq("screen and (max-width: 680px)")&&(a=0),0,TweenMax.to(d,.6,{css:{autoAlpha:1},ease:Quart.easeInOut,delay:1}),TweenMax.to(d,.8,{css:{className:"-=intro-min",height:g},ease:Quart.easeOut,onComplete:function(){d.css("height","auto")}}),TweenMax.fromTo($(".rms-wall"),.8,{opacity:a},{opacity:1,className:"-=rms-wall-min",ease:Quart.easeInOut,onComplete:function(){}}),TweenMax.to(e.find(".rms-image-bar"),.6,{autoAlpha:1,height:"auto",ease:Quart.easeInOut}),TweenMax.to($(".rms-name-active"),1,{className:"-=rms-name-active",ease:Quart.easeInOut})},a.loadRoomType=function(a){var b=$('.rms-column[data-llo-room="'+a+'"]');b.addClass("rms-column-active"),TweenMax.to($(".rms-wall"),.8,{css:{height:65,overflow:"hidden"},ease:Quart.easeOut,delay:.4}),_.each(e,function(a,b){var c=$(a).find(".rms-image-bar");TweenMax.to(c,.6,{autoAlpha:0,ease:Sine.easeOut,delay:.1*b,onComplete:function(){c.addClass("h-hide")}})})},a.selectRoom=function(a){var b=$('.rms-column[data-llo-room="'+a+'"]'),c=b.find(".rms-name");TweenMax.to(d,.6,{css:{autoAlpha:0},ease:Quart.easeInOut}),TweenMax.to(d,.8,{css:{height:0},ease:Quart.easeOut,delay:.5,onComplete:function(){d.addClass("intro-min")}}),TweenMax.to($(".rms-name-active"),1,{className:"-=rms-name-active",ease:Quart.easeInOut}),TweenMax.to(c,.8,{className:"+=rms-name-active",ease:Quart.easeOut}),TweenMax.to(e.find(".rms-image-bar"),.8,{autoAlpha:0,height:0,ease:Quart.easeInOut}),TweenMax.to($(".rms-wall"),.8,{className:"+=rms-wall-min",ease:Quart.easeInOut})},a.roomHover=function(a){var b=$('.rms-column[data-llo-room="'+a+'"]'),c=b.find(".rms-image-bar .rms-bar-desktop"),d=b.index(".rms-column"),e=-30;d>3&&(e*=-1);var f={left:-100,scale:1};Modernizr.mq("screen and (max-width: 1024px)")&&(f.left=0),TweenMax.to(c,1,{css:f,transformOrigin:"center center",ease:Quart.easeOut,force3D:!0})},a.roomMouseleave=function(a){var b=$('.rms-column[data-llo-room="'+a+'"]'),c=b.find(".rms-image-bar .rms-bar-desktop"),d={left:0,scale:1.2};Modernizr.mq("screen and (max-width: 1024px)")&&(d.scale=1),TweenMax.to(c,1,{css:d,transformOrigin:"center center",ease:Quart.easeOut,force3D:!0})}}]),angular.module("roomDetails",["lloydsInnApp"]).controller("RoomDetailsController",["$scope","$stateParams",function(a,b){function c(b){a.image=b.item.src,a.$apply(),a.status="ready"}var d=a.dataService.getRooms(b.shortName),e=new createjs.LoadQueue(!1);a.imageIndex=0,a.shortName=d.shortName,a.title=d.niceName,a.image=d.image,a.description=d.description,a.gallery=d.gallery,a.type=d.type,a.$parent.selectRoom(a.shortName),a.$parent.showRooms=!0,a.features=d.features,e.on("fileload",c,this,!1),a.loadImage=function(a){var b=d.gallery[a].image;e.loadFile({id:"bigimage",src:b,type:createjs.LoadQueue.IMAGE})},a.selectImage=function(b){a.imageIndex=b},a.isActive=function(b){return a.imageIndex===b}}]),angular.module("faq",[]).controller("FaqController",["$rootScope","$scope","$http","$timeout",function(a,b,c,d){function e(){_.each($(".faq-item"),function(a,b){f(b)})}function f(a){var b=$(".faq-item").eq(a),c=b.find(".faq-item-q"),d=b.find(".faq-item-a");b.attr("data-answer-height",c.outerHeight()+d.outerHeight()+10),b.height(b.hasClass("active")?b.attr("data-answer-height"):c.outerHeight())}b.faqLoaded=!1;var g=[];c.get(a.wpAPI+"/posts/",{headers:{"Content-type":"application/json"},params:{type:"faq","filter[posts_per_page]":-1}}).success(function(a){_.each(a,function(a){var b={question:a.title,answer:a.post_meta.answer[0].replace(/\n\r?/g,"<br />"),active:!1};g.push(b)}),b.faq=g,b.faqLoaded=!0,b.status="ready"}),b.hideAnswer=function(a){TweenMax.to($(".faq-item").eq(a),2,{marginTop:0,autoAlpha:1,delay:.05*a,ease:Expo.easeOut}),d(function(){f(a)},0)},b.toggleQuestion=function(a){var b=g[a],c=0,d=_.findWhere(g,{active:!0});b.element=$(".faq-item").eq(a);var e=b.element.find(".faq-item-q"),f=b.element.find(".faq-item-a");_.contains(_.pluck(g,"active"),!0)&&(c=.2),b.active=!b.active,b.active?("undefined"!=typeof d&&(d.element=$(".faq-item").eq(_.indexOf(g,d)),d.active=!1,TweenMax.to(d.element,.4,{css:{height:d.element.find(".faq-item-q").outerHeight()}})),TweenMax.to(b.element,.6,{height:e.outerHeight()+f.outerHeight()+5,delay:c,ease:Quart.easeInOut})):TweenMax.to(b.element,.4,{css:{height:e.outerHeight()}})},$(window).resize(function(){e()})}]),angular.module("facilities",[]).controller("FacilitiesController",["$scope","$http",function(a,b){b.get("facilities.json").success(function(b){0,a.facilities=b.facilities}),a.status="ready"}]);